"use strict";(self.webpackChunkParkingClip=self.webpackChunkParkingClip||[]).push([[325],{39968:function(e,t,n){var a=n(1582),r=n(20890),s=n(61889),i=n(81918),o=n(81317),c=n(80184),l=function(e){var t=e.color,n=e.title,l=e.count,u=e.percentage;e.isLoss,e.extra;return(0,c.jsx)(o.Z,{contentSX:{p:2.25},children:(0,c.jsxs)(a.Z,{spacing:.5,children:[(0,c.jsx)(r.Z,{variant:"h6",color:"textSecondary",children:n}),(0,c.jsxs)(s.ZP,{container:!0,alignItems:"center",children:[(0,c.jsx)(s.ZP,{item:!0,children:(0,c.jsx)(r.Z,{variant:"h4",color:"inherit",children:l})}),u&&(0,c.jsx)(s.ZP,{item:!0,children:(0,c.jsx)(i.Z,{variant:"combined",color:t,label:"".concat(u,"%"),sx:{ml:1.25,pl:1},size:"small"})})]})]})})};l.defaultProps={color:"primary"},t.Z=l},55325:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var a=n(37762),r=n(74165),s=n(15861),i=n(29439),o=n(72791),c=n(31243),l=n(2982),u=n(13496),d=n(61889),h=n(20890),f=n(1582),p=n(36151),m=n(64554),x=n(1413),v=n(13967),Z=n(80184),g={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}},y=function(e){var t=e.slot,n=e.location,a=e.business,r=(0,v.Z)(),s=r.palette.text,d=(s.primary,s.secondary),h=r.palette.divider,f=(0,o.useState)(g),p=(0,i.Z)(f,2),m=p[0],y=p[1],j=(0,o.useState)([{name:"Tickets Generated",data:[0,86,28,115,48,210,136]}]),b=(0,i.Z)(j,2),k=b[0],S=b[1],w=(0,o.useState)(!0),D=(0,i.Z)(w,2),P=D[0],I=D[1],E=l.Z+"api/parkings/vehicle/tickets?businessId="+a.businessId+"&location="+n.name,C=(0,o.useState)([]),M=(0,i.Z)(C,2),T=M[0],A=M[1];(0,o.useEffect)((function(){J()}),[n]);var J=function(){try{c.Z.get(E).then((function(e){A(e.data.data.data)}))}catch(e){}};return(0,o.useEffect)((function(){if(T){var e={},n=[],a=[],s={},i=[],o=new Date,c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if("month"===t){for(var l=new Date,u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=0;f<12;f++){var p=new Date(l.getFullYear(),l.getMonth()-f,1),m=u[p.getMonth()];i.unshift(m),s[m]=0}T.forEach((function(e){var t=new Date(e.entryDateTime),n=u[t.getMonth()];void 0!==s[n]&&s[n]++})),i.forEach((function(e){a.push(s[e])}))}else{for(var v=0;v<7;v++){var Z=new Date(o.getFullYear(),o.getMonth(),o.getDate()-v),g=c[Z.getDay()];n.unshift(g),e[g]=0}T.forEach((function(t){var n=new Date(t.entryDateTime),a=c[n.getDay()];void 0!==e[a]&&e[a]++})),n.forEach((function(t){a.push(e[t])}))}S([{name:"month"===t?"Tickets Generated":"Tickets Generated (Last 7 days)",data:a}]),y((function(e){return(0,x.Z)((0,x.Z)({},e),{},{colors:[r.palette.primary.main,r.palette.primary[700]],xaxis:{categories:"month"===t?i:n,labels:{style:{colors:[d,d,d,d,d,d,d,d,d,d,d,d]}},axisBorder:{show:!0,color:h},tickAmount:"month"===t?11:7},yaxis:{labels:{style:{colors:[d]}}},grid:{borderColor:h},tooltip:{theme:"light"}})})),I(!1)}}),[t,T]),P?(0,Z.jsx)("div",{children:"Loading..."}):(0,Z.jsx)(u.Z,{options:m,series:k,type:"area",height:450})},j={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}},b=function(e){var t=e.slot,n=e.location,a=e.business,d=(0,v.Z)(),h=d.palette.text,f=(h.primary,h.secondary),p=d.palette.divider,m=(0,o.useState)(j),g=(0,i.Z)(m,2),y=g[0],b=g[1],k=(0,o.useState)([{name:"Revenue Generated",data:[0,86,28,115,48,210,136]}]),S=(0,i.Z)(k,2),w=S[0],D=S[1],P=(0,o.useState)(!0),I=(0,i.Z)(P,2),E=I[0],C=I[1],M=(JSON.parse(localStorage.getItem("userdata")),l.Z+"api/businesses/revenue/"+a.businessId+"?location="+n.name),T=(0,o.useState)([]),A=(0,i.Z)(T,2),J=A[0],N=A[1];(0,o.useEffect)((function(){F()}),[n]);var F=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get(M).then((function(e){e.data.message,N(e.data.data)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){if(J){var e={},n=[],a=[],r={},s=[],i=new Date,o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if("month"===t){for(var c=new Date,l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=0;u<12;u++){var h=new Date(c.getFullYear(),c.getMonth()-u,1),m=l[h.getMonth()];s.unshift(m),r[m]=0}J.forEach((function(e){var t=e.date.split("-"),n=parseInt(t[1])-1,a=l[n];void 0!==r[a]&&(r[a]+=e.totalAmount)})),s.forEach((function(e){a.push(r[e])}))}else{for(var v=0;v<7;v++){var Z=o[new Date(i.getFullYear(),i.getMonth(),i.getDate()-v).getDay()];n.unshift(Z),J[v]?e[Z]=J[v].totalAmount:e[Z]=0}n.forEach((function(t){a.push(e[t])}))}D([{name:"month"===t?"Revenue Generated":"Revenue Generated (Last 7 days)",data:a}]),b((function(e){return(0,x.Z)((0,x.Z)({},e),{},{colors:[d.palette.primary.main,d.palette.primary[700]],xaxis:{categories:"month"===t?s:n,labels:{style:{colors:[f,f,f,f,f,f,f,f,f,f,f,f]}},axisBorder:{show:!0,color:p},tickAmount:"month"===t?11:7},yaxis:{labels:{style:{colors:[f]}}},grid:{borderColor:p},tooltip:{theme:"light"}})})),C(!1)}}),[t,J]),E?(0,Z.jsx)("div",{children:"Loading..."}):(0,Z.jsx)(u.Z,{options:y,series:w,type:"area",height:450})},k=n(81317),S=n(39968),w=function(){var e=(0,o.useState)("week"),t=(0,i.Z)(e,2),n=t[0],x=t[1],v=JSON.parse(localStorage.getItem("userdata")),g=(0,o.useState)([]),j=(0,i.Z)(g,2),w=j[0],D=j[1],P=(0,o.useState)("no location found"),I=(0,i.Z)(P,2),E=I[0],C=I[1],M=(0,o.useState)([]),T=(0,i.Z)(M,2),A=T[0],J=T[1],N=(0,o.useState)("no business found"),F=(0,i.Z)(N,2),L=F[0],O=F[1],R=(0,o.useState)({}),G=(0,i.Z)(R,2),z=G[0],B=G[1],W=(0,o.useState)(0),Y=(0,i.Z)(W,2),K=Y[0],V=Y[1],X=(0,o.useState)(0),q=(0,i.Z)(X,2),H=q[0],Q=q[1];(0,o.useEffect)((function(){U()}),[]);var U=function(){c.Z.get(l.Z+"api/businesses").then((function(e){J(e.data.data.data),O(e.data.data.data[0]),D(e.data.data.data[0].locations),C(e.data.data.data[0].locations[0])}))},$=w.find((function(e){return e.name===E.name})),_=0;if($)for(var ee=0;ee<$.vehicleDetails.length;ee++)_+=parseInt($.vehicleDetails[ee].capacity);var te=(0,o.useState)([]),ne=(0,i.Z)(te,2),ae=ne[0],re=ne[1];(0,o.useEffect)((function(){se()}),[$]);var se=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(l.Z+"api/parkings/vehicle/tickets/"+L.businessId+"?location="+E.name),e.next=4,c.Z.get(l.Z+"api/parkings/vehicle/tickets?businessId="+L.businessId+"&location="+E.name).then((function(e){"No Records Found!"===e.data.message?re(e.data.data):re(e.data.data.data)}));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("error",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){if(ae){var e,t={},n=0,r=(0,a.Z)(ae);try{for(r.s();!(e=r.n()).done;){var s=e.value;"PARKED"===s.parkingStatus&&(n++,t[s.vehicleType]?t[s.vehicleType]++:t[s.vehicleType]=1)}}catch(i){r.e(i)}finally{r.f()}V(n),B(t)}}),[ae]);var ie=l.Z+"api/businesses/revenue/"+v.userId+"?location="+E,oe=(0,o.useState)([]),ce=(0,i.Z)(oe,2),le=ce[0],ue=ce[1];(0,o.useEffect)((function(){de()}),[$]);var de=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get(ie).then((function(e){e.data.message,ue(e.data.data)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){if(le){var e,t=0,n=(0,a.Z)(le);try{for(n.s();!(e=n.n()).done;){t+=e.value.totalAmount}}catch(r){n.e(r)}finally{n.f()}Q(t)}}),[le]),(0,Z.jsxs)(d.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,Z.jsx)(d.ZP,{item:!0,xs:12,children:(0,Z.jsxs)("div",{className:"formInput",style:{display:"flex",alignItems:"center"},children:[(0,Z.jsx)(h.Z,{variant:"h5",children:"Dashboard for business: "}),(0,Z.jsx)("select",{style:{marginLeft:10,marginRight:10},id:"businessselect",onChange:function(e){var t=JSON.parse(e.target.value);t.locations[0]?(O(t),D(t.locations),C(t.locations[0])):alert("no location found for Business Selected, Please Reload... ")},children:A.map((function(e){return(0,Z.jsx)("option",{value:JSON.stringify(e),children:e.businessName})}))}),(0,Z.jsx)(h.Z,{variant:"h5",children:"At location: "}),(0,Z.jsx)("select",{style:{marginLeft:10},id:"locationSelect",onChange:function(e){var t=JSON.parse(e.target.value);C(t)},children:w.map((function(e){return(0,Z.jsx)("option",{value:JSON.stringify(e),children:e.name})}))})]})}),$&&$.vehicleDetails.map((function(e,t){return(0,Z.jsx)(d.ZP,{item:!0,xs:12,sm:6,md:4,lg:4,children:void 0!==z[e.type]?(0,Z.jsx)(S.Z,{title:"".concat(e.type),count:"".concat(z[e.type]," / ").concat(e.capacity)}):null},t)})),(0,Z.jsxs)(d.ZP,{item:!0,xs:12,md:7,lg:8,children:[(0,Z.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(d.ZP,{item:!0,children:(0,Z.jsxs)(h.Z,{variant:"h5",children:["Total Revuenue Generated: ",H]})}),(0,Z.jsx)(d.ZP,{item:!0,children:(0,Z.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:0,children:[(0,Z.jsx)(p.Z,{size:"small",onClick:function(){return x("month")},color:"month"===n?"primary":"secondary",variant:"month"===n?"outlined":"text",children:"Month"}),(0,Z.jsx)(p.Z,{size:"small",onClick:function(){return x("week")},color:"week"===n?"primary":"secondary",variant:"week"===n?"outlined":"text",children:"Week"})]})})]}),(0,Z.jsx)(k.Z,{content:!1,sx:{mt:1.5},children:(0,Z.jsx)(m.Z,{sx:{pt:1,pr:2},children:(0,Z.jsx)(b,{slot:n,location:E,business:L})})})]}),(0,Z.jsxs)(d.ZP,{item:!0,xs:12,md:5,lg:4,children:[(0,Z.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(d.ZP,{item:!0,children:(0,Z.jsx)(h.Z,{variant:"h5",children:"Parking Slots Report"})}),(0,Z.jsx)(d.ZP,{item:!0})]}),(0,Z.jsxs)(k.Z,{sx:{mt:2},content:!1,children:[_&&(0,Z.jsx)(m.Z,{sx:{p:3,pb:0},children:(0,Z.jsxs)(f.Z,{spacing:2,children:[(0,Z.jsx)(h.Z,{variant:"h6",color:"textSecondary",children:"Currently"}),(0,Z.jsxs)(h.Z,{variant:"h3",children:[K,"/",_]})]})}),(0,Z.jsx)("div",{id:"chart",style:{marginBottom:20},children:(0,Z.jsx)(u.Z,{options:{labels:["Occupied","Vacant"],legend:{position:"bottom"}},series:[K,_-K],type:"pie",width:350})})]})]}),(0,Z.jsxs)(d.ZP,{item:!0,xs:12,md:7,lg:8,children:[(0,Z.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,Z.jsx)(d.ZP,{item:!0,children:(0,Z.jsxs)(h.Z,{variant:"h5",children:["Total Tickets Generated: ",ae.length]})}),(0,Z.jsx)(d.ZP,{item:!0,children:(0,Z.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:0,children:[(0,Z.jsx)(p.Z,{size:"small",onClick:function(){return x("month")},color:"month"===n?"primary":"secondary",variant:"month"===n?"outlined":"text",children:"Month"}),(0,Z.jsx)(p.Z,{size:"small",onClick:function(){return x("week")},color:"week"===n?"primary":"secondary",variant:"week"===n?"outlined":"text",children:"Week"})]})})]}),(0,Z.jsx)(k.Z,{content:!1,sx:{mt:1.5},children:(0,Z.jsx)(m.Z,{sx:{pt:1,pr:2},children:(0,Z.jsx)(y,{slot:n,location:E,business:L})})})]})]})}},2982:function(e,t){t.Z="/server/parking-management-service/"}}]);
//# sourceMappingURL=325.8ed7576b.chunk.js.map