"use strict";(self.webpackChunkParkingClip=self.webpackChunkParkingClip||[]).push([[443],{39968:function(e,t,n){var a=n(1582),r=n(20890),i=n(61889),o=n(81918),s=n(81317),c=n(80184),l=function(e){var t=e.color,n=e.title,l=e.count,u=e.percentage;e.isLoss,e.extra;return(0,c.jsx)(s.Z,{contentSX:{p:2.25},children:(0,c.jsxs)(a.Z,{spacing:.5,children:[(0,c.jsx)(r.Z,{variant:"h6",color:"textSecondary",children:n}),(0,c.jsxs)(i.ZP,{container:!0,alignItems:"center",children:[(0,c.jsx)(i.ZP,{item:!0,children:(0,c.jsx)(r.Z,{variant:"h4",color:"inherit",children:l})}),u&&(0,c.jsx)(i.ZP,{item:!0,children:(0,c.jsx)(o.Z,{variant:"combined",color:t,label:"".concat(u,"%"),sx:{ml:1.25,pl:1},size:"small"})})]})]})})};l.defaultProps={color:"primary"},t.Z=l},70443:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});var a=n(37762),r=n(74165),i=n(15861),o=n(29439),s=n(72791),c=n(31243),l=n(2982),u=n(13496),d=n(61889),h=n(20890),f=n(1582),p=n(36151),m=n(64554),x=n(1413),Z=n(13967),v=n(80184),g={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}},y=function(e){var t=e.slot,n=e.location,a=(0,Z.Z)(),r=a.palette.text,i=(r.primary,r.secondary),d=a.palette.divider,h=(0,s.useState)(g),f=(0,o.Z)(h,2),p=f[0],m=f[1],y=(0,s.useState)([{name:"Tickets Generated",data:[0,86,28,115,48,210,136]}]),j=(0,o.Z)(y,2),k=j[0],w=j[1],S=(0,s.useState)(!0),b=(0,o.Z)(S,2),D=b[0],P=b[1],T=l.Z+"api/parkings/vehicle/tickets?fromDate=Tue Feb 14 2023 15:09:20 GMT+0530 (India Standard Time)&toDate=Sun Apr 20 2023 13:56:18 GMT+0530 (India Standard Time)&limit=10000&location="+n,E=(0,s.useState)([]),I=(0,o.Z)(E,2),M=I[0],C=I[1];(0,s.useEffect)((function(){A()}),[n]);var A=function(){try{c.Z.get(T).then((function(e){C(e.data.data.data)}))}catch(e){}};return(0,s.useEffect)((function(){if(M){var e={},n=[],r=[],o={},s=[],c=new Date,l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if("month"===t){for(var u=new Date,h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],f=0;f<12;f++){var p=new Date(u.getFullYear(),u.getMonth()-f,1),Z=h[p.getMonth()];s.unshift(Z),o[Z]=0}M.forEach((function(e){var t=new Date(e.entryDateTime),n=h[t.getMonth()];void 0!==o[n]&&o[n]++})),s.forEach((function(e){r.push(o[e])}))}else{for(var v=0;v<7;v++){var g=new Date(c.getFullYear(),c.getMonth(),c.getDate()-v),y=l[g.getDay()];n.unshift(y),e[y]=0}M.forEach((function(t){var n=new Date(t.entryDateTime),a=l[n.getDay()];void 0!==e[a]&&e[a]++})),n.forEach((function(t){r.push(e[t])}))}w([{name:"month"===t?"Tickets Generated":"Tickets Generated (Last 7 days)",data:r}]),m((function(e){return(0,x.Z)((0,x.Z)({},e),{},{colors:[a.palette.primary.main,a.palette.primary[700]],xaxis:{categories:"month"===t?s:n,labels:{style:{colors:[i,i,i,i,i,i,i,i,i,i,i,i]}},axisBorder:{show:!0,color:d},tickAmount:"month"===t?11:7},yaxis:{labels:{style:{colors:[i]}}},grid:{borderColor:d},tooltip:{theme:"light"}})})),P(!1)}}),[t,M]),D?(0,v.jsx)("div",{children:"Loading..."}):(0,v.jsx)(u.Z,{options:p,series:k,type:"area",height:450})},j={chart:{height:450,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},grid:{strokeDashArray:0}},k=function(e){var t=e.slot,n=e.location,a=(0,Z.Z)(),d=a.palette.text,h=(d.primary,d.secondary),f=a.palette.divider,p=(0,s.useState)(j),m=(0,o.Z)(p,2),g=m[0],y=m[1],k=(0,s.useState)([{name:"Revenue Generated",data:[0,86,28,115,48,210,136]}]),w=(0,o.Z)(k,2),S=w[0],b=w[1],D=(0,s.useState)(!0),P=(0,o.Z)(D,2),T=P[0],E=P[1],I=JSON.parse(localStorage.getItem("userdata")),M=l.Z+"api/businesses/revenue/"+I.userId+"?location="+n,C=(0,s.useState)([]),A=(0,o.Z)(C,2),F=A[0],G=A[1];(0,s.useEffect)((function(){J()}),[n]);var J=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get(M).then((function(e){e.data.message,G(e.data.data)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){if(F){var e={},n=[],r=[],i={},o=[],s=new Date,c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];if("month"===t){for(var l=new Date,u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=0;d<12;d++){var p=new Date(l.getFullYear(),l.getMonth()-d,1),m=u[p.getMonth()];o.unshift(m),i[m]=0}F.forEach((function(e){var t=e.date.split("-"),n=parseInt(t[1])-1,a=u[n];void 0!==i[a]&&(i[a]+=e.totalAmount)})),o.forEach((function(e){r.push(i[e])}))}else{for(var Z=0;Z<7;Z++){var v=c[new Date(s.getFullYear(),s.getMonth(),s.getDate()-Z).getDay()];n.unshift(v),F[Z]?e[v]=F[Z].totalAmount:e[v]=0}n.forEach((function(t){r.push(e[t])}))}b([{name:"month"===t?"Revenue Generated":"Revenue Generated (Last 7 days)",data:r}]),y((function(e){return(0,x.Z)((0,x.Z)({},e),{},{colors:[a.palette.primary.main,a.palette.primary[700]],xaxis:{categories:"month"===t?o:n,labels:{style:{colors:[h,h,h,h,h,h,h,h,h,h,h,h]}},axisBorder:{show:!0,color:f},tickAmount:"month"===t?11:7},yaxis:{labels:{style:{colors:[h]}}},grid:{borderColor:f},tooltip:{theme:"light"}})})),E(!1)}}),[t,F]),T?(0,v.jsx)("div",{children:"Loading..."}):(0,v.jsx)(u.Z,{options:g,series:S,type:"area",height:450})},w=n(81317),S=n(39968),b=function(){var e=(0,s.useState)("week"),t=(0,o.Z)(e,2),n=t[0],x=t[1],Z=JSON.parse(localStorage.getItem("userdata")),g=(0,s.useState)([]),j=(0,o.Z)(g,2),b=j[0],D=j[1],P=(0,s.useState)("no location found"),T=(0,o.Z)(P,2),E=T[0],I=T[1],M=(0,s.useState)({}),C=(0,o.Z)(M,2),A=C[0],F=C[1],G=(0,s.useState)(0),J=(0,o.Z)(G,2),L=J[0],R=J[1],N=(0,s.useState)(0),z=(0,o.Z)(N,2),O=z[0],W=z[1];(0,s.useEffect)((function(){Y()}),[]);var Y=function(){c.Z.get(l.Z+"api/businesses/"+Z.userId).then((function(e){D(e.data.data.locations),I(e.data.data.locations[0].name)}))},B=b.find((function(e){return e.name===E})),K=0;if(B)for(var V=0;V<B.vehicleDetails.length;V++)K+=parseInt(B.vehicleDetails[V].capacity);var X=l.Z+"api/parkings/vehicle/tickets?limit=10000&location="+E,q=(0,s.useState)([]),H=(0,o.Z)(q,2),Q=H[0],U=H[1];(0,s.useEffect)((function(){$()}),[B]);var $=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get(X).then((function(e){"No Records Found!"===e.data.message?U(e.data.data):U(e.data.data.data)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){if(Q){var e,t={},n=0,r=(0,a.Z)(Q);try{for(r.s();!(e=r.n()).done;){var i=e.value;"PARKED"===i.parkingStatus&&(n++,t[i.vehicleType]?t[i.vehicleType]++:t[i.vehicleType]=1)}}catch(o){r.e(o)}finally{r.f()}R(n),F(t)}}),[Q]);var _=l.Z+"api/businesses/revenue/"+Z.userId+"?location="+E,ee=(0,s.useState)([]),te=(0,o.Z)(ee,2),ne=te[0],ae=te[1];(0,s.useEffect)((function(){re()}),[B]);var re=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.Z.get(_).then((function(e){e.data.message,ae(e.data.data)}));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("error",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){if(ne){var e,t=0,n=(0,a.Z)(ne);try{for(n.s();!(e=n.n()).done;){t+=e.value.totalAmount}}catch(r){n.e(r)}finally{n.f()}W(t)}}),[ne]),(0,v.jsxs)(d.ZP,{container:!0,rowSpacing:4.5,columnSpacing:2.75,children:[(0,v.jsx)(d.ZP,{item:!0,xs:12,children:(0,v.jsxs)("div",{className:"formInput",style:{display:"flex",alignItems:"center"},children:[(0,v.jsx)(h.Z,{variant:"h5",children:"Showing Dashboard for "}),(0,v.jsx)("select",{id:"locationSelect",onChange:function(e){var t=e.target.value;I(t)},style:{marginLeft:"10px"},children:b.map((function(e){return(0,v.jsx)("option",{value:e.name,children:e.name})}))})]})}),B&&B.vehicleDetails.map((function(e,t){return(0,v.jsx)(d.ZP,{item:!0,xs:12,sm:6,md:4,lg:4,children:void 0!==A[e.type]?(0,v.jsx)(S.Z,{title:"".concat(e.type),count:"".concat(A[e.type]," / ").concat(e.capacity)}):null},t)})),(0,v.jsxs)(d.ZP,{item:!0,xs:12,md:7,lg:8,children:[(0,v.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,v.jsx)(d.ZP,{item:!0,children:(0,v.jsxs)(h.Z,{variant:"h5",children:["Total Revuenue Generated: ",O]})}),(0,v.jsx)(d.ZP,{item:!0,children:(0,v.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:0,children:[(0,v.jsx)(p.Z,{size:"small",onClick:function(){return x("month")},color:"month"===n?"primary":"secondary",variant:"month"===n?"outlined":"text",children:"Month"}),(0,v.jsx)(p.Z,{size:"small",onClick:function(){return x("week")},color:"week"===n?"primary":"secondary",variant:"week"===n?"outlined":"text",children:"Week"})]})})]}),(0,v.jsx)(w.Z,{content:!1,sx:{mt:1.5},children:(0,v.jsx)(m.Z,{sx:{pt:1,pr:2},children:(0,v.jsx)(k,{slot:n,location:E})})})]}),(0,v.jsxs)(d.ZP,{item:!0,xs:12,md:5,lg:4,children:[(0,v.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,v.jsx)(d.ZP,{item:!0,children:(0,v.jsx)(h.Z,{variant:"h5",children:"Parking Slots Report"})}),(0,v.jsx)(d.ZP,{item:!0})]}),(0,v.jsxs)(w.Z,{sx:{mt:2},content:!1,children:[K&&(0,v.jsx)(m.Z,{sx:{p:3,pb:0},children:(0,v.jsxs)(f.Z,{spacing:2,children:[(0,v.jsx)(h.Z,{variant:"h6",color:"textSecondary",children:"Currently"}),(0,v.jsxs)(h.Z,{variant:"h3",children:[L,"/",K]})]})}),(0,v.jsx)("div",{id:"chart",style:{marginBottom:20},children:(0,v.jsx)(u.Z,{options:{labels:["Occupied","Vacant"],legend:{position:"bottom"}},series:[L,K-L],type:"pie",width:350})})]})]}),(0,v.jsxs)(d.ZP,{item:!0,xs:12,md:7,lg:8,children:[(0,v.jsxs)(d.ZP,{container:!0,alignItems:"center",justifyContent:"space-between",children:[(0,v.jsx)(d.ZP,{item:!0,children:(0,v.jsxs)(h.Z,{variant:"h5",children:["Total Tickets Generated: ",Q.length]})}),(0,v.jsx)(d.ZP,{item:!0,children:(0,v.jsxs)(f.Z,{direction:"row",alignItems:"center",spacing:0,children:[(0,v.jsx)(p.Z,{size:"small",onClick:function(){return x("month")},color:"month"===n?"primary":"secondary",variant:"month"===n?"outlined":"text",children:"Month"}),(0,v.jsx)(p.Z,{size:"small",onClick:function(){return x("week")},color:"week"===n?"primary":"secondary",variant:"week"===n?"outlined":"text",children:"Week"})]})})]}),(0,v.jsx)(w.Z,{content:!1,sx:{mt:1.5},children:(0,v.jsx)(m.Z,{sx:{pt:1,pr:2},children:(0,v.jsx)(y,{slot:n,location:E})})})]})]})}},2982:function(e,t){t.Z="/server/parking-management-service/"}}]);
//# sourceMappingURL=443.95fb2174.chunk.js.map